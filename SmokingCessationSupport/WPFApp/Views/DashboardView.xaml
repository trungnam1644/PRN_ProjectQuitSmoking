<Window
    x:Class="WPFApp.Views.DashboardView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:conv="clr-namespace:WPFApp.Converters"
    xmlns:lvc="clr-namespace:LiveCharts.Wpf;assembly=LiveCharts.Wpf"
    xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
    Title="Tổng quan"
    Width="1200"
    Height="800"
    FontFamily="Segoe UI"
    WindowStartupLocation="CenterScreen">

    <Window.Resources>
        <!--  Converters  -->
        <conv:BoolToVisibilityConverter x:Key="BooleanToVisibilityConverter" />

        <!--  Color Palette  -->
        <SolidColorBrush x:Key="PrimaryColor" Color="#2ecc40" />
        <SolidColorBrush x:Key="SecondaryColor" Color="#4CAF50" />
        <SolidColorBrush x:Key="DarkTextColor" Color="#212121" />
        <SolidColorBrush x:Key="LightTextColor" Color="#757575" />
        <SolidColorBrush x:Key="CardBackground" Color="#FFFFFF" />
        <SolidColorBrush x:Key="PageBackground" Color="#FAFAFA" />

        <!--  Card Style  -->
        <Style TargetType="materialDesign:Card">
            <Setter Property="Background" Value="{StaticResource CardBackground}" />
            <Setter Property="Margin" Value="10" />
            <Setter Property="Padding" Value="20" />
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect
                        BlurRadius="15"
                        ShadowDepth="3"
                        Color="#10000000" />
                </Setter.Value>
            </Setter>
            <Setter Property="BorderThickness" Value="0" />
        </Style>

        <!--  Stat Card Style  -->
        <Style
            x:Key="StatCard"
            BasedOn="{StaticResource {x:Type materialDesign:Card}}"
            TargetType="materialDesign:Card">
            <Setter Property="Width" Value="280" />
            <Setter Property="Height" Value="140" />
            <Setter Property="Padding" Value="15" />
        </Style>

        <!--  Primary Button Style  -->
        <Style x:Key="PrimaryButton" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource PrimaryColor}" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="FontSize" Value="14" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="Height" Value="50" />
            <Setter Property="Width" Value="200" />
            <Setter Property="Margin" Value="5" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Cursor" Value="Hand" />
        </Style>

        <!--  Navigation Button Style  -->
        <Style x:Key="NavButton" TargetType="Button">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="Foreground" Value="{StaticResource DarkTextColor}" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Height" Value="80" />
            <Setter Property="Width" Value="80" />
            <Setter Property="Margin" Value="5" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="ToolTipService.Placement" Value="Bottom" />
        </Style>
        <!--  Stat Title Style  -->
        <Style x:Key="StatTitle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="16" />
            <Setter Property="FontWeight" Value="Bold" />
            <Setter Property="Foreground" Value="#2ecc40" />
            <Setter Property="Margin" Value="0,0,0,5" />
        </Style>
        <!--  Stat Value Style  -->
        <Style x:Key="StatValue" TargetType="TextBlock">
            <Setter Property="FontSize" Value="28" />
            <Setter Property="FontWeight" Value="Bold" />
            <Setter Property="Foreground" Value="#212121" />
            <Setter Property="Margin" Value="0,0,0,2" />
        </Style>
        <!--  Stat SubText Style  -->
        <Style x:Key="StatSubText" TargetType="TextBlock">
            <Setter Property="FontSize" Value="12" />
            <Setter Property="Foreground" Value="#757575" />
            <Setter Property="Margin" Value="0,0,0,0" />
        </Style>
        <!--  Section Title Style  -->
        <Style x:Key="SectionTitle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="18" />
            <Setter Property="FontWeight" Value="Bold" />
            <Setter Property="Foreground" Value="#2ecc40" />
            <Setter Property="Margin" Value="0,0,0,10" />
        </Style>
        <!--  Body Text Style  -->
        <Style x:Key="BodyText" TargetType="TextBlock">
            <Setter Property="FontSize" Value="14" />
            <Setter Property="Foreground" Value="#212121" />
        </Style>
        <!--  Caption Text Style  -->
        <Style x:Key="CaptionText" TargetType="TextBlock">
            <Setter Property="FontSize" Value="11" />
            <Setter Property="Foreground" Value="#757575" />
        </Style>
    </Window.Resources>

    <Grid Background="{StaticResource PageBackground}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!--  Header  -->
        <Border
            Grid.Row="0"
            Padding="15"
            Background="{StaticResource PrimaryColor}">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <StackPanel VerticalAlignment="Center" Orientation="Horizontal">
                    <materialDesign:PackIcon
                        Width="32"
                        Height="32"
                        Foreground="White"
                        Kind="ViewDashboard" />
                    <TextBlock
                        Margin="10,0,0,0"
                        FontSize="22"
                        FontWeight="Bold"
                        Foreground="White"
                        Text="TỔNG QUAN CAI THUỐC LÁ" />
                </StackPanel>

                <StackPanel Grid.Column="2" Orientation="Horizontal">
                    <Button
                        Click="GoToProfileButton_Click"
                        Style="{StaticResource MaterialDesignIconButton}"
                        ToolTip="Hồ sơ">
                        <materialDesign:PackIcon Foreground="White" Kind="AccountCircle" />
                    </Button>
                    <Button
                        Click="Button_Click"
                        Style="{StaticResource MaterialDesignIconButton}"
                        ToolTip="Đăng xuất">
                        <materialDesign:PackIcon Foreground="White" Kind="Logout" />
                    </Button>
                </StackPanel>
            </Grid>
        </Border>

        <!--  Main Content  -->
        <ScrollViewer Grid.Row="1" Padding="20">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <!--  Kế hoạch hiện tại với thanh tiến độ  -->
                <materialDesign:Card Grid.Row="1" Margin="0,20">
                    <StackPanel>
                        <TextBlock Style="{StaticResource SectionTitle}" Text="KẾ HOẠCH HIỆN TẠI" />

                        <StackPanel Margin="0,10" Orientation="Horizontal">
                            <TextBlock
                                FontWeight="SemiBold"
                                Text="{Binding CurrentPlanDashboard.Name}"
                                TextWrapping="Wrap" />
                        </StackPanel>

                        <Grid Margin="0,15">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>

                            <ProgressBar
                                Height="10"
                                Foreground="{StaticResource SecondaryColor}"
                                Maximum="100"
                                Value="{Binding CurrentPlanDashboard.Progress}" />

                            <TextBlock
                                Grid.Column="1"
                                Margin="10,0,0,0"
                                FontWeight="Bold"
                                Text="{Binding CurrentPlanDashboard.Progress, StringFormat='{}{0:F2}%'}" />
                        </Grid>

                        <StackPanel HorizontalAlignment="Right" Orientation="Horizontal">
                            <TextBlock Style="{StaticResource CaptionText}" Text="Bắt đầu: " />
                            <TextBlock
                                FontWeight="SemiBold"
                                Style="{StaticResource CaptionText}"
                                Text="{Binding CurrentPlanDashboard.StartDate, StringFormat='{}{0:dd/MM/yyyy}'}" />
                            <TextBlock
                                Margin="10,0,0,0"
                                Style="{StaticResource CaptionText}"
                                Text=" - Kết thúc: " />
                            <TextBlock
                                FontWeight="SemiBold"
                                Style="{StaticResource CaptionText}"
                                Text="{Binding CurrentPlanDashboard.EndDate, StringFormat='{}{0:dd/MM/yyyy}'}" />
                        </StackPanel>
                    </StackPanel>
                </materialDesign:Card>

                <!--  Lịch sử nhật ký gần đây  -->
                <materialDesign:Card Grid.Row="2" Margin="0,20">
                    <StackPanel>
                        <TextBlock Style="{StaticResource SectionTitle}" Text="NHẬT KÝ GẦN ĐÂY" />

                        <DataGrid
                            AutoGenerateColumns="False"
                            BorderThickness="0"
                            HeadersVisibility="Column"
                            IsReadOnly="True"
                            ItemsSource="{Binding RecentJournals}"
                            RowHeight="40">

                            <DataGrid.Columns>
                                <DataGridTextColumn
                                    Width="120"
                                    Binding="{Binding Date, StringFormat='{}{0:dd/MM/yyyy}'}"
                                    Header="Ngày" />
                                <DataGridTextColumn
                                    Width="100"
                                    Binding="{Binding Cigarettes}"
                                    Header="Số điếu/ngày" />
                                <DataGridTextColumn
                                    Width="150"
                                    Binding="{Binding HealthStatus}"
                                    Header="Tình trạng sức khỏe" />
                              
                            </DataGrid.Columns>
                        </DataGrid>
                    </StackPanel>
                </materialDesign:Card>
            </Grid>
        </ScrollViewer>

        <Border
            Grid.Row="2"
            Background="White"
            BorderBrush="#E0E0E0"
            BorderThickness="0,1,0,0">
            <StackPanel HorizontalAlignment="Center" Orientation="Horizontal">
                <!--  Đã bỏ Trang chủ và Tiến trình  -->
                <Button
                    Click="GoToSmokingStatusButton_Click"
                    Style="{StaticResource NavButton}"
                    ToolTip="Nhật ký">
                    <StackPanel>
                        <materialDesign:PackIcon
                            Width="24"
                            Height="24"
                            Kind="Notebook" />
                        <TextBlock
                            Margin="0,5,0,0"
                            FontSize="10"
                            Text="Nhật ký" />
                    </StackPanel>
                </Button>
                <Button
                    Click="GoToQuitPlanButton_Click"
                    Style="{StaticResource NavButton}"
                    ToolTip="Kế hoạch">
                    <StackPanel>
                        <materialDesign:PackIcon
                            Width="24"
                            Height="24"
                            Kind="CalendarEdit" />
                        <TextBlock
                            Margin="0,5,0,0"
                            FontSize="10"
                            Text="Kế hoạch" />
                    </StackPanel>
                </Button>
                <Button
                    Click="GoToCommunityButton_Click"
                    Style="{StaticResource NavButton}"
                    ToolTip="Cộng đồng">
                    <StackPanel>
                        <materialDesign:PackIcon
                            Width="24"
                            Height="24"
                            Kind="AccountGroup" />
                        <TextBlock
                            Margin="0,5,0,0"
                            FontSize="10"
                            Text="Cộng đồng" />
                    </StackPanel>
                </Button>
                <Button
                    Click="GoToMembershipButton_Click"
                    Style="{StaticResource NavButton}"
                    ToolTip="Thành viên">
                    <StackPanel>
                        <materialDesign:PackIcon
                            Width="24"
                            Height="24"
                            Kind="AccountStar" />
                        <TextBlock
                            Margin="0,5,0,0"
                            FontSize="10"
                            Text="Thành viên" />
                    </StackPanel>
                </Button>
                <Button
                    Click="GoToCoachListButton_Click"
                    Style="{StaticResource NavButton}"
                    ToolTip="Coach">
                    <StackPanel>
                        <materialDesign:PackIcon
                            Width="24"
                            Height="24"
                            Kind="AccountSupervisor" />
                        <TextBlock
                            Margin="0,5,0,0"
                            FontSize="10"
                            Text="Coach" />
                    </StackPanel>
                </Button>
            </StackPanel>
        </Border>
    </Grid>
</Window>